var x=Object.create;var h=Object.defineProperty;var A=Object.getOwnPropertyDescriptor;var E=Object.getOwnPropertyNames;var L=Object.getPrototypeOf,K=Object.prototype.hasOwnProperty;var S=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var v=(e,t,o,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let c of E(t))!K.call(e,c)&&c!==o&&h(e,c,{get:()=>t[c],enumerable:!(s=A(t,c))||s.enumerable});return e};var F=(e,t,o)=>(o=e!=null?x(L(e)):{},v(t||!e||!e.__esModule?h(o,"default",{value:e,enumerable:!0}):o,e));var w=S(($,P)=>{P.exports=b;b.flatten=b;b.unflatten=C;function O(e){return e&&e.constructor&&typeof e.constructor.isBuffer=="function"&&e.constructor.isBuffer(e)}function R(e){return e}function b(e,t){t=t||{};let o=t.delimiter||".",s=t.maxDepth,c=t.transformKey||R,f={};function g(l,m,p){p=p||1,Object.keys(l).forEach(function(r){let n=l[r],i=t.safe&&Array.isArray(n),a=Object.prototype.toString.call(n),u=O(n),j=a==="[object Object]"||a==="[object Array]",y=m?m+o+c(r):c(r);if(!i&&!u&&j&&Object.keys(n).length&&(!t.maxDepth||p<s))return g(n,y,p+1);f[y]=n})}return g(e),f}function C(e,t){t=t||{};let o=t.delimiter||".",s=t.overwrite||!1,c=t.transformKey||R,f={};if(O(e)||Object.prototype.toString.call(e)!=="[object Object]")return e;function l(r){let n=Number(r);return isNaN(n)||r.indexOf(".")!==-1||t.object?r:n}function m(r,n,i){return Object.keys(i).reduce(function(a,u){return a[r+o+u]=i[u],a},n)}function p(r){let n=Object.prototype.toString.call(r),i=n==="[object Array]",a=n==="[object Object]";if(r){if(i)return!r.length;if(a)return!Object.keys(r).length}else return!0}return e=Object.keys(e).reduce(function(r,n){let i=Object.prototype.toString.call(e[n]);return!(i==="[object Object]"||i==="[object Array]")||p(e[n])?(r[n]=e[n],r):m(n,r,b(e[n],t))},{}),Object.keys(e).forEach(function(r){let n=r.split(o).map(c),i=l(n.shift()),a=l(n[0]),u=f;for(;a!==void 0;){if(i==="__proto__")return;let j=Object.prototype.toString.call(u[i]),y=j==="[object Object]"||j==="[object Array]";if(!s&&!y&&typeof u[i]<"u")return;(s&&!y||!s&&u[i]==null)&&(u[i]=typeof a=="number"&&!t.object?[]:{}),u=u[i],n.length>0&&(i=l(n.shift()),a=l(n[0]))}u[i]=C(e[r],t)}),f}});var d=F(w(),1);async function z(e){let[t,o]=e.pluginConfig.pathPattern.split("{language}"),s=o.startsWith("/"),c=await e.$fs.readdir(t),f=[];console.log(t,"pathBeforeLanguage"),console.log(s,"pathAfterLanguageisDirectory");for(let g of c)typeof g=="string"&&g.endsWith(".json")&&f.push(g.replace(".json",""));return f}async function D(e){let t=[];for(let o of e.config.languages){let s=e.pluginConfig.pathPattern.replace("{language}",o),c=(0,d.default)(JSON.parse(await e.$fs.readFile(s,"utf-8")));t.push(T(c,o))}return t}async function I(e){for(let t of e.resources){let o=e.pluginConfig.pathPattern.replace("{language}",t.languageTag.name);await e.$fs.writeFile(o,M(t))}}function T(e,t){return console.log(e.id),{type:"Resource",languageTag:{type:"LanguageTag",name:t},body:Object.entries(e).map(([o,s])=>B(o,s))}}function B(e,t){return{type:"Message",id:{type:"Identifier",name:e},pattern:{type:"Pattern",elements:[{type:"Text",value:t}]}}}function M(e){let t=Object.fromEntries(e.body.map(N));return JSON.stringify(d.default.unflatten(t),null,2)}function N(e){return[e.id.name,e.pattern.elements[0].value]}export{z as getLanguages,D as readResources,I as writeResources};
