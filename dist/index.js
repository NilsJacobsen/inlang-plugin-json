var E=Object.create;var j=Object.defineProperty;var I=Object.getOwnPropertyDescriptor;var T=Object.getOwnPropertyNames;var A=Object.getPrototypeOf,C=Object.prototype.hasOwnProperty;var _=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var B=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of T(t))!C.call(e,s)&&s!==n&&j(e,s,{get:()=>t[s],enumerable:!(r=I(t,s))||r.enumerable});return e};var K=(e,t,n)=>(n=e!=null?E(A(e)):{},B(t||!e||!e.__esModule?j(n,"default",{value:e,enumerable:!0}):n,e));var R=_((Y,O)=>{O.exports=y;y.flatten=y;y.unflatten=x;function w(e){return e&&e.constructor&&typeof e.constructor.isBuffer=="function"&&e.constructor.isBuffer(e)}function P(e){return e}function y(e,t){t=t||{};let n=t.delimiter||".",r=t.maxDepth,s=t.transformKey||P,i={};function h(l,d,p){p=p||1,Object.keys(l).forEach(function(a){let o=l[a],c=t.safe&&Array.isArray(o),u=Object.prototype.toString.call(o),f=w(o),m=u==="[object Object]"||u==="[object Array]",g=d?d+n+s(a):s(a);if(!c&&!f&&m&&Object.keys(o).length&&(!t.maxDepth||p<r))return h(o,g,p+1);i[g]=o})}return h(e),i}function x(e,t){t=t||{};let n=t.delimiter||".",r=t.overwrite||!1,s=t.transformKey||P,i={};if(w(e)||Object.prototype.toString.call(e)!=="[object Object]")return e;function l(a){let o=Number(a);return isNaN(o)||a.indexOf(".")!==-1||t.object?a:o}function d(a,o,c){return Object.keys(c).reduce(function(u,f){return u[a+n+f]=c[f],u},o)}function p(a){let o=Object.prototype.toString.call(a),c=o==="[object Array]",u=o==="[object Object]";if(a){if(c)return!a.length;if(u)return!Object.keys(a).length}else return!0}return e=Object.keys(e).reduce(function(a,o){let c=Object.prototype.toString.call(e[o]);return!(c==="[object Object]"||c==="[object Array]")||p(e[o])?(a[o]=e[o],a):d(o,a,y(e[o],t))},{}),Object.keys(e).forEach(function(a){let o=a.split(n).map(s),c=l(o.shift()),u=l(o[0]),f=i;for(;u!==void 0;){if(c==="__proto__")return;let m=Object.prototype.toString.call(f[c]),g=m==="[object Object]"||m==="[object Array]";if(!r&&!g&&typeof f[c]<"u")return;(r&&!g||!r&&f[c]==null)&&(f[c]=typeof u=="number"&&!t.object?[]:{}),f=f[c],o.length>0&&(c=l(o.shift()),u=l(o[0]))}f[c]=x(e[a],t)}),i}});function b(e){return t=>n=>e({settings:t,env:n})}var v=K(R(),1);var $=M;function M(e,t,n){var r,s;if(Array.isArray(t)&&(r=t.slice(0)),typeof t=="string"&&(r=t.split(".")),typeof t=="symbol"&&(r=[t]),!Array.isArray(r))throw new Error("props arg must be an array, a string or a symbol");if(s=r.pop(),!s)return!1;S(s);for(var i;i=r.shift();)if(S(i),typeof e[i]>"u"&&(e[i]={}),e=e[i],!e||typeof e!="object")return!1;return e[s]=n,!0}function S(e){if(e=="__proto__"||e=="constructor"||e=="prototype")throw new Error("setting of prototype values not supported")}var N=b(({settings:e,env:t})=>({id:"samuelstroschein.inlangPluginJson",async config(){return{languages:await J({$fs:t.$fs,settings:e}),readResources:async n=>L({...n,$fs:t.$fs,settings:e}),writeResources:async n=>k({...n,$fs:t.$fs,settings:e})}}}));async function J(e){let[t,n]=e.settings.pathPattern.split("{language}"),r=await e.$fs.readdir(t),s=[];for(let i of r)typeof i=="string"&&i.endsWith(".json")&&s.push(i.replace(".json",""));return s}async function L(e){let t=[];for(let n of e.config.languages){let r=e.settings.pathPattern.replace("{language}",n),s=JSON.parse(await e.$fs.readFile(r,{encoding:"utf-8"})),i=(0,v.default)(s);t.push(z(i,n))}return t}async function k(e){for(let t of e.resources){let n=e.settings.pathPattern.replace("{language}",t.languageTag.name);await e.$fs.writeFile(n,D(t))}}function z(e,t){return{type:"Resource",languageTag:{type:"LanguageTag",name:t},body:Object.entries(e).map(([n,r])=>F(n,r))}}function F(e,t){let n=/({[^}]+})/g,r=t.split(n),s=[];for(let i=0;i<r.length;i++)n.test(r[i])?s.push({type:"Placeholder",body:{type:"VariableReference",name:r[i].slice(1,-1)}}):s.push({type:"Text",value:r[i]});return{type:"Message",id:{type:"Identifier",name:e},pattern:{type:"Pattern",elements:s}}}function D(e){let t={};return e.body.forEach(n=>{let[r,s]=V(n);$(t,r,s)}),JSON.stringify(t,null,2)}function V(e){let t=[];for(let r of e.pattern.elements)r.type==="Text"?t.push(r.value):r.type==="Placeholder"&&t.push(`{${r.body.name}}`);let n=t.join("");return[e.id.name,n]}export{N as default};
/*! Bundled license information:

@inlang/core/dist/plugin/pluginBuildConfig.js:
  (*! DON'T TOP-LEVEL IMPORT ESBUILD PLUGINS. USE DYNAMIC IMPORTS. *)
  (*! See https://github.com/inlang/inlang/issues/486 *)
*/
