var E=Object.create;var j=Object.defineProperty;var I=Object.getOwnPropertyDescriptor;var T=Object.getOwnPropertyNames;var A=Object.getPrototypeOf,C=Object.prototype.hasOwnProperty;var _=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var B=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of T(t))!C.call(e,i)&&i!==n&&j(e,i,{get:()=>t[i],enumerable:!(r=I(t,i))||r.enumerable});return e};var K=(e,t,n)=>(n=e!=null?E(A(e)):{},B(t||!e||!e.__esModule?j(n,"default",{value:e,enumerable:!0}):n,e));var R=_((Y,O)=>{O.exports=y;y.flatten=y;y.unflatten=x;function P(e){return e&&e.constructor&&typeof e.constructor.isBuffer=="function"&&e.constructor.isBuffer(e)}function w(e){return e}function y(e,t){t=t||{};let n=t.delimiter||".",r=t.maxDepth,i=t.transformKey||w,o={};function h(l,d,p){p=p||1,Object.keys(l).forEach(function(a){let s=l[a],c=t.safe&&Array.isArray(s),u=Object.prototype.toString.call(s),f=P(s),m=u==="[object Object]"||u==="[object Array]",g=d?d+n+i(a):i(a);if(!c&&!f&&m&&Object.keys(s).length&&(!t.maxDepth||p<r))return h(s,g,p+1);o[g]=s})}return h(e),o}function x(e,t){t=t||{};let n=t.delimiter||".",r=t.overwrite||!1,i=t.transformKey||w,o={};if(P(e)||Object.prototype.toString.call(e)!=="[object Object]")return e;function l(a){let s=Number(a);return isNaN(s)||a.indexOf(".")!==-1||t.object?a:s}function d(a,s,c){return Object.keys(c).reduce(function(u,f){return u[a+n+f]=c[f],u},s)}function p(a){let s=Object.prototype.toString.call(a),c=s==="[object Array]",u=s==="[object Object]";if(a){if(c)return!a.length;if(u)return!Object.keys(a).length}else return!0}return e=Object.keys(e).reduce(function(a,s){let c=Object.prototype.toString.call(e[s]);return!(c==="[object Object]"||c==="[object Array]")||p(e[s])?(a[s]=e[s],a):d(s,a,y(e[s],t))},{}),Object.keys(e).forEach(function(a){let s=a.split(n).map(i),c=l(s.shift()),u=l(s[0]),f=o;for(;u!==void 0;){if(c==="__proto__")return;let m=Object.prototype.toString.call(f[c]),g=m==="[object Object]"||m==="[object Array]";if(!r&&!g&&typeof f[c]<"u")return;(r&&!g||!r&&f[c]==null)&&(f[c]=typeof u=="number"&&!t.object?[]:{}),f=f[c],s.length>0&&(c=l(s.shift()),u=l(s[0]))}f[c]=x(e[a],t)}),o}});function b(e){return t=>n=>e({settings:t,env:n})}var v=K(R(),1);var $=M;function M(e,t,n){var r,i;if(Array.isArray(t)&&(r=t.slice(0)),typeof t=="string"&&(r=t.split(".")),typeof t=="symbol"&&(r=[t]),!Array.isArray(r))throw new Error("props arg must be an array, a string or a symbol");if(i=r.pop(),!i)return!1;S(i);for(var o;o=r.shift();)if(S(o),typeof e[o]>"u"&&(e[o]={}),e=e[o],!e||typeof e!="object")return!1;return e[i]=n,!0}function S(e){if(e=="__proto__"||e=="constructor"||e=="prototype")throw new Error("setting of prototype values not supported")}var N=b(({settings:e,env:t})=>({id:"samuelstroschein.inlangPluginJson",async config(){return{languages:await J({$fs:t.$fs,settings:e}),readResources:async n=>L({...n,$fs:t.$fs,settings:e}),writeResources:async n=>k({...n,$fs:t.$fs,settings:e})}}}));async function J(e){let[t,n]=e.settings.pathPattern.split("{language}"),r=await e.$fs.readdir(t),i=[];for(let o of r)typeof o=="string"&&o.endsWith(".json")&&i.push(o.replace(".json",""));return i}async function L(e){let t=[];for(let n of e.config.languages){let r=e.settings.pathPattern.replace("{language}",n),i=JSON.parse(await e.$fs.readFile(r,{encoding:"utf-8"})),o=(0,v.default)(i);t.push(z(o,n,e.settings.variableReferencePattern))}return t}async function k(e){for(let t of e.resources){let n=e.settings.pathPattern.replace("{language}",t.languageTag.name);await e.$fs.writeFile(n,D(t))}}function z(e,t,n){return{type:"Resource",languageTag:{type:"LanguageTag",name:t},body:Object.entries(e).map(([r,i])=>F(r,i,n))}}function F(e,t,n){let r=t.split(n||"(?!.*)"),i=[];for(let o=0;o<r.length;o++)new RegExp(n||"(?!.*)").test(r[o])?i.push({type:"Placeholder",body:{type:"VariableReference",name:r[o].slice(1,-1)}}):i.push({type:"Text",value:r[o]});return{type:"Message",id:{type:"Identifier",name:e},pattern:{type:"Pattern",elements:i}}}function D(e){let t={};return e.body.forEach(n=>{let[r,i]=V(n);$(t,r,i)}),JSON.stringify(t,null,2)}function V(e){let t=[];for(let r of e.pattern.elements)r.type==="Text"?t.push(r.value):r.type==="Placeholder"&&t.push(`{${r.body.name}}`);let n=t.join("");return[e.id.name,n]}export{N as default};
/*! Bundled license information:

@inlang/core/dist/plugin/pluginBuildConfig.js:
  (*! DON'T TOP-LEVEL IMPORT ESBUILD PLUGINS. USE DYNAMIC IMPORTS. *)
  (*! See https://github.com/inlang/inlang/issues/486 *)
*/
